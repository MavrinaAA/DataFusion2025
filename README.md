# DataFusion2025

[![image](https://github.com/user-attachments/assets/b48cc238-a2c7-4dce-9fa9-2abac4e151d5)](https://ods.ai/competitions/data-fusion2025-labelcraft)


**Описание хакатона**

DataFusion2025 "Label Craft" — это хакатон по классификации товаров по категориям с использованием иерархической структуры категорий. Проект включает в себя подготовку данных, обучение модели и оценку ее эффективности с учетом иерархической структуры категорий.
[Страница соревнования DataFusion2025](https://ods.ai/competitions/data-fusion2025-labelcraft/dataset)

**Структура проекта**

```bash
DataFusion2025/
├── data/
│   ├── raw/                  # Исходные данные
│   │   ├── category_tree.csv        # Словарь с деревом категорий (необходимо скачать со страницы хакатона и добавить в папку raw)
│   │   ├── labeled_train.parquet    # Размеченные данные о товарах (необходимо скачать со страницы хакатона и добавить в папку raw)
│   │   ├── unlabeled_special_prize.parquet  # Дополнительная разметка, полученная благодаря специальной механике (необходимо скачать со страницы хакатона и добавить в папку raw)
│   │   ├── unlabeled_train.parquet  # Неразмеченные данные о товарах (необходимо скачать со страницы хакатона и добавить в папку raw)
│   │   ├── unlabeled_dorazmetka.parquet  # Дополнительные данные, размеченные с помощью LLM
│   │   └── new_items.parquet        # Объекты для категорий, которые не представлены в обучающей выборке, сгенерированные с помощью LLM
│   └── processed/            # Обработанные данные
│       ├── train.parquet     # Данные для обучения
│       ├── val.parquet       # Данные для валидации
│       └── bad_labeled.parquet  # Данные с нелистовыми категориями
├── src/
│   ├── category_tree/        # Модуль работы с деревом категорий
│   │   └── category_tree.py  # Класс для работы с иерархией категорий
│   └── metrics/              # Модуль для оценки качества моделей
│       ├── hierarchical_accuracy.py  # Реализация иерархической метрики точности
│       └── transformers_metrics.py   # Метрики для моделей Transformers
└── pipeline.py               # Основной скрипт подготовки данных
│
└── Labelling_LLM.ipynb       # Jupyter-notebook для доразметки данных с помощью LLM
│
└── Training.ipynb            # Jupyter-notebook для обучения модели

```
**Подготовка данных**

Процесс подготовки данных включает следующие этапы:

1. Разделение размеченных данных на "хорошие" (с листовыми категориями) и "плохие" (с нелистовыми категориями)
2. Создание валидационной выборки с учетом стратификации по категориям
3. Обогащение обучающей выборки данными из неразмеченных источников с помощью сопоставления атрибутов
4. Генерация с помощью LLM дополнительных данных для категорий, которые не представлены в обучающем датасете
5. Доразметка с помощью LLM данных из обучающей выборки


Запуск подготовки данных:

```bash
python pipeline.py
```
**Метрика оценки**

В хакатоне используется специальная метрика иерархической точности, которая учитывает структуру дерева категорий при оценке предсказаний. Метрика основана на поиске наибольшего общего предка (LCA) между предсказанной и истинной категориями и вычислении штрафа в зависимости от расстояния между ними в дереве.

**Работа с иерархией категорий**

Класс `CategoryTree` предоставляет функциональность для работы с иерархией категорий:

- Загрузка дерева категорий из CSV-файла
- Определение листовых узлов (конечных категорий)
- Построение графа категорий для анализа их взаимосвязей

**Модели**

Проект предполагает использование моделей на базе Transformers для классификации товаров. Для оценки качества моделей используется специальная метрика hierarchical_accuracy, которая учитывает иерархическую структуру категорий. В моем решении используется предобученная русскоязычная трансформер-модель "cointegrated/rubert-tiny2".
